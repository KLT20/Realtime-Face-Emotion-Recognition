#saves the images from the train csv into a train folder


from __future__ import print_function
import pandas as pd
import numpy as np
from PIL import Image
import os
from tqdm import tqdm

class Generate_data():
    def __init__(self, datapath):
        self.data_path = datapath
        
        
# this function takes in the string of pixels from the csv file and converts it into
# a PIL image object

   def str_to_image(self, str_img = ' '):
        
        imgarray_str = str_img.split(' ')
        imgarray = np.asarray(imgarray_str,dtype=np.uint8).reshape(48,48)
        return Image.fromarray(imgarray)

# here we create the new folder the saved images of the training set get stored into

    def save_images(self, datatype='train'):
       
        foldername= self.data_path+"/"+datatype
        csvfile_path= self.data_path+"/"+datatype+'.csv'

        data = pd.read_csv(csvfile_path)
        #dataframe to series pandas
        images = data['pixels'] 
        numberofimages = images.shape[0]
        for index in tqdm(range(numberofimages)):
            img = self.str_to_image(images[index])
            img.save(os.path.join(foldername,'{}{}.jpg'.format(datatype,index)),'JPEG')
        print('Done saving {} data'.format((foldername)))
